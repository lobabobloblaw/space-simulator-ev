<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EventBus Debug</title>
    <link rel="stylesheet" href="./css/main.css">
</head>
<body>
    <div id="tutorialHint"></div>
    <canvas id="gameCanvas"></canvas>
    
    <!-- HUD elements needed by the game -->
    <div id="gameHUD">
        <div class="hud-container">
            <div class="hud-left">
                <div class="status-grid">
                    <div><span id="health">100%</span></div>
                    <div><span id="shield">NONE</span></div>
                    <div><span id="fuel">100%</span></div>
                    <div><span id="speed">0.0</span></div>
                    <div><span id="cargo">0/10</span></div>
                    <div><span id="location">SPACE</span></div>
                </div>
            </div>
            <div class="hud-center">
                <div><span id="credits">250</span></div>
                <div><span id="weapon">NONE</span></div>
                <div><span id="kills">0</span></div>
            </div>
            <div class="hud-right">
                <canvas id="minimapCanvas" width="100" height="100"></canvas>
            </div>
        </div>
    </div>
    
    <div id="landingOverlay" style="display:none;">
        <div id="landingHeader"><h3 id="planetName">Planet</h3></div>
        <div id="landingContent">
            <canvas id="planetCanvas" width="420" height="472"></canvas>
            <div id="landingInfo">
                <div id="landingMessage"></div>
                <div id="planetDescription"></div>
                <div id="landingDetails"></div>
            </div>
            <div id="tradingPanel">
                <span id="tradeCredits">0</span>
                <span id="tradeCargo">0/10</span>
                <div id="commodityList"></div>
            </div>
            <div id="shopPanel">
                <span id="shopCredits">0</span>
                <div id="shopList"></div>
            </div>
        </div>
        <div id="landingButtons">
            <button id="departBtn">DEPART</button>
            <button id="stationBtn">STATION</button>
            <button id="tradeBtn">TRADE</button>
            <button id="outfitterBtn">OUTFITTER</button>
        </div>
    </div>

    <script type="module">
        console.log('=== EventBus Debug Loading ===');
        
        // Track what loads
        window.loadingStatus = {
            started: true,
            modules: {}
        };
        
        import('./js/main_eventbus.js')
            .then(module => {
                console.log('✅ main_eventbus.js loaded successfully!');
                window.loadingStatus.success = true;
                
                // Check what was initialized
                setTimeout(() => {
                    console.log('EventBus:', typeof window.eventBus);
                    console.log('StateManager:', typeof window.stateManager);
                    console.log('Systems:', typeof window.eventBusSystems);
                    
                    if (window.eventBus) {
                        console.log('✅ EVENTBUS DEPLOYMENT SUCCESSFUL!');
                    }
                }, 1000);
            })
            .catch(error => {
                console.error('❌ Failed to load main_eventbus.js:', error);
                window.loadingStatus.error = error.message;
                alert('Error loading EventBus: ' + error.message);
            });
    </script>
</body>
</html>
